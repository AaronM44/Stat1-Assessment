---
title: "Stats1 Assessment"
author: "Aaron Munro"
date: "2022-12-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

## Main Findings

## Executive Summary

## Dataset Overview
The dataset I chose to use for the assessment was found on Kaggle. Over a period of a year in 2015, data was collected that contains the details of beer consumption of students around a university area in Sao Paulo, Brazil.

The original columns were in Brazilian so I have translated them for this project:

- Data - Date
- Temperatura Media (C) - Median Temp. (C)
- Temperatura Minima (C) - Min. Temp (C)
- Temperatura Maxima (C) - Max. Temp (C)
- Precipitacao (mm) - Precipitation (mm)
- Final de Semana - Weekend
- Consumo de cerveja (litros) - Consumption (litres)


## Hypothesis
Does an increase in temperature lead to an increase in beer consumption among students in Sao Paulo, Brazil?

H0 - Increased temperatures do not lead to an increase in beer consumption.

H1 - Increased temperatures do lead to an increase in beer consumption

``` {r imports, echo=FALSE}
# Import packages
library(tidyverse)
library(patchwork)
library(lubridate)
```

## Original Dataset Analysis

``` {r orig_read}
# Import data - dataset has commas instead of decimal points and many blank rows
orig_data <- read.csv("data/Consumo_cerveja.csv", dec = ",")
orig_data <- orig_data[1:365,]

set.seed(7)
```

``` {r orig_rename}
# Rename columns
orig_data <- orig_data %>%
  rename(date = Data,
         temp_median = Temperatura.Media..C.,
         temp_min = Temperatura.Minima..C.,
         temp_max = Temperatura.Maxima..C.,
         precip = Precipitacao..mm.,
         weekend = Final.de.Semana,
         consum = Consumo.de.cerveja..litros.)
```

``` {r orig_head}
head(orig_data)
```

``` {r orig_comma_rep}
# Format fields correctly
orig_data$date <- as_date(as.Date(orig_data$date))
orig_data$temp_median <- as.numeric(orig_data$temp_median)
orig_data$temp_min <- as.numeric(orig_data$temp_min)
orig_data$temp_max <- as.numeric(orig_data$temp_max)
orig_data$precip <- as.numeric(orig_data$precip)
orig_data$weekend <- as.factor(orig_data$weekend)
orig_data$consum <- as.numeric(as.character(orig_data$consum))
```

``` {r orig_summary}
summary(orig_data)
```

``` {r orig_add_month}
orig_data <- orig_data %>%
  mutate(mo = month(date))
```

``` {r orig_distr, echo=FALSE}
orig_p1 <- ggplot(orig_data, aes(x = temp_median)) +
  geom_histogram(bins = 10) +
  labs(title = "Distribution of Median Temperature",
       x = "Temperature (C)",
       y = "Count") +
  geom_vline(aes(xintercept = mean(temp_median)),col='red',linewidth=0.5) +
  geom_vline(aes(xintercept = median(temp_median)),col='green',linewidth=0.5)

orig_p2 <- ggplot(orig_data, aes(x = temp_min)) +
  geom_histogram(bins = 10) +
  labs(title = "Distribution of Min. Temperature",
       x = "Temperature (C)",
       y = "Count") +
  geom_vline(aes(xintercept = mean(temp_min)),col='red',linewidth=0.5) +
  geom_vline(aes(xintercept = median(temp_min)),col='green',linewidth=0.5)

orig_p3 <- ggplot(orig_data, aes(x = temp_max)) +
  geom_histogram(bins = 10) +
  labs(title = "Distribution of Max. Temperature",
       x = "Temperature (C)",
       y = "Count") +
  geom_vline(aes(xintercept = mean(temp_max)),col='red',linewidth=0.5) +
  geom_vline(aes(xintercept = median(temp_max)),col='green',linewidth=0.5)

orig_p4 <- ggplot(orig_data, aes(x = precip)) +
  geom_histogram(bins = 10) +
  labs(title = "Distribution of Precipitation",
       x = "Precipitation (mm)",
       y = "Count") +
  geom_vline(aes(xintercept = mean(precip)),col='red',linewidth=0.5) +
  geom_vline(aes(xintercept = median(precip)),col='green',linewidth=0.5)

orig_p5 <- ggplot(orig_data, aes(x = weekend)) +
  geom_bar() +
  labs(title = "Count of Weekdays vs Weekends",
       x = "Weekend",
       y = "Count")

orig_p6 <- ggplot(orig_data, aes(x = consum)) +
  geom_histogram(bins = 10) +
  labs(title = "Distribution of Beer Consumption",
       x = "Consumption (litres)",
       y = "Count") +
  geom_vline(aes(xintercept = mean(consum)),col='red',linewidth=0.5) +
  geom_vline(aes(xintercept = median(consum)),col='green',linewidth=0.5)

orig_patchwork <- orig_p1 + orig_p2 + orig_p3 + orig_p4 + orig_p5 + orig_p6
orig_patchwork + plot_annotation(
  title = 'Original Dataset Overview',
  subtitle = 'Red Line - Mean, Green Line - Median'
)
```

``` {r orig_time}
orig_time_p1 <- ggplot(orig_data, aes(x = mo, y = temp_median, group = mo)) +
  geom_boxplot() +
  scale_x_continuous(breaks = seq(1,12,1)) +
  stat_summary(fun = "mean", aes(ymax = after_stat(y), ymin = after_stat(y)), 
               color = "red", shape = 4)

orig_time_p2 <- ggplot(orig_data, aes(x = mo, y = temp_min, group = mo)) +
  geom_boxplot() +
  scale_x_continuous(breaks = seq(1,12,1)) +
  stat_summary(fun = "mean", aes(ymax = after_stat(y), ymin = after_stat(y)), 
               color = "red", shape = 4)

orig_time_p3 <- ggplot(orig_data, aes(x = mo, y = temp_max, group = mo)) +
  geom_boxplot() +
  scale_x_continuous(breaks = seq(1,12,1)) +
  stat_summary(fun = "mean", aes(ymax = after_stat(y), ymin = after_stat(y)), 
               color = "red", shape = 4)

orig_time_p4 <- ggplot(orig_data, aes(x = mo, y = precip, group = mo)) +
  geom_boxplot() +
  scale_x_continuous(breaks = seq(1,12,1)) +
  stat_summary(fun = "mean", aes(ymax = after_stat(y), ymin = after_stat(y)), 
               color = "red", shape = 4)

orig_patchwork <- orig_time_p1 + orig_time_p2 + orig_time_p3 + 
  orig_time_p4
orig_patchwork + plot_annotation(
  title = 'Continuous Variables by Month'
)
```

## Simulated Data

### Date Range
``` {r sim_date}
# defining start date
start_date <- ymd("2015/01/01")
  
# defining end date
end_date <- ymd("2015/12/31")
  
# generating range of dates
dates <- seq(start_date, end_date,"days")

```

``` {r sim_data}
sim_data <- tibble(
  temp_median = rnorm(365, mean = 45, sd = 20)
)
#mutate(across(where(is.numeric), round, digits = 0)) # Round numerical data to 0 decimal places
```



## Conclusion




